Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 1997777
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #1 called N=1, H=227, W=227, CI=3, FH=3, FW=3, CO=64, S=2, Padding VALID (0 0 0 0)
expect -5174 but got -5173
expect 13 but got 14
expect 2 but got 1
expect -19 but got -20
[32mConvolution Output Matches[0m
Maxpool 1 called N=1, H=56, W=56, C=64, ksizeH=3, ksizeW=3
Relu task 1
Relu #1 on 200704 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #2 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=16, S=1, Padding VALID (0 0 0 0)
expect 8229653 but got 8229654
expect 3892937 but got 3892938
[32mConvolution Output Matches[0m
Relu task 1
Relu #3 on 50176 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #3 called N=1, H=56, W=56, CI=16, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
expect -745947 but got -745946
expect 6866155 but got 6866156
[32mConvolution Output Matches[0m
Relu task 1
Relu #5 on 200704 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #4 called N=1, H=56, W=56, CI=16, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
expect -10296274 but got -10296273
expect -2353888 but got -2353887
[32mConvolution Output Matches[0m
Relu task 1
Relu #7 on 200704 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #5 called N=1, H=56, W=56, CI=128, FH=1, FW=1, CO=16, S=1, Padding VALID (0 0 0 0)
expect 14214984 but got 14214985
expect 10106798 but got 10106799
[32mConvolution Output Matches[0m
Relu task 1
Relu #9 on 50176 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #6 called N=1, H=56, W=56, CI=16, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
expect 739850 but got 739851
expect -1231015 but got -1231014
[32mConvolution Output Matches[0m
Relu task 1
Relu #11 on 200704 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #7 called N=1, H=56, W=56, CI=16, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
expect -8513829 but got -8513828
expect -606028 but got -606027
[32mConvolution Output Matches[0m
Relu task 1
Relu #13 on 200704 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Maxpool 2 called N=1, H=27, W=27, C=128, ksizeH=3, ksizeW=3
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #8 called N=1, H=27, W=27, CI=128, FH=1, FW=1, CO=32, S=1, Padding VALID (0 0 0 0)
expect 29187801 but got 29187802
expect 12957916 but got 12957917
[32mConvolution Output Matches[0m
Relu task 1
Relu #15 on 23328 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #9 called N=1, H=27, W=27, CI=32, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
expect 12931895 but got 12931896
expect 9562066 but got 9562067
[32mConvolution Output Matches[0m
Relu task 1
Relu #17 on 93312 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #10 called N=1, H=27, W=27, CI=32, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
expect -4026221 but got -4026220
expect 1260254 but got 1260255
[32mConvolution Output Matches[0m
Relu task 1
Relu #19 on 93312 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #11 called N=1, H=27, W=27, CI=256, FH=1, FW=1, CO=32, S=1, Padding VALID (0 0 0 0)
expect -6387733 but got -6387732
expect 46780766 but got 46780767
[32mConvolution Output Matches[0m
Relu task 1
Relu #21 on 23328 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #12 called N=1, H=27, W=27, CI=32, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
expect -734014 but got -734013
expect -13420870 but got -13420869
[32mConvolution Output Matches[0m
Relu task 1
Relu #23 on 93312 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #13 called N=1, H=27, W=27, CI=32, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
expect -3036714 but got -3036713
expect 333401 but got 333402
[32mConvolution Output Matches[0m
Relu task 1
Relu #25 on 93312 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Maxpool 3 called N=1, H=13, W=13, C=256, ksizeH=3, ksizeW=3
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #14 called N=1, H=13, W=13, CI=256, FH=1, FW=1, CO=48, S=1, Padding VALID (0 0 0 0)
expect -7713276 but got -7713275
expect 27162089 but got 27162090
[32mConvolution Output Matches[0m
Relu task 1
Relu #27 on 8112 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #15 called N=1, H=13, W=13, CI=48, FH=1, FW=1, CO=192, S=1, Padding VALID (0 0 0 0)
expect -15739402 but got -15739401
expect -14642172 but got -14642171
expect -1523439 but got -1523440
expect -8448785 but got -8448786
[32mConvolution Output Matches[0m
Relu task 1
Relu #29 on 32448 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #16 called N=1, H=13, W=13, CI=48, FH=3, FW=3, CO=192, S=1, Padding SAME (1 1 1 1)
expect -39151877 but got -39151876
expect -16610141 but got -16610140
[32mConvolution Output Matches[0m
Relu task 1
Relu #31 on 32448 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #17 called N=1, H=13, W=13, CI=384, FH=1, FW=1, CO=48, S=1, Padding VALID (0 0 0 0)
expect -5260419 but got -5260418
expect -5778404 but got -5778403
[32mConvolution Output Matches[0m
Relu task 1
Relu #33 on 8112 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #18 called N=1, H=13, W=13, CI=48, FH=1, FW=1, CO=192, S=1, Padding VALID (0 0 0 0)
expect -8849376 but got -8849375
expect -8001404 but got -8001403
expect -8402775 but got -8402776
[32mConvolution Output Matches[0m
Relu task 1
Relu #35 on 32448 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #19 called N=1, H=13, W=13, CI=48, FH=3, FW=3, CO=192, S=1, Padding SAME (1 1 1 1)
expect -11884228 but got -11884227
expect -2425889 but got -2425888
[32mConvolution Output Matches[0m
Relu task 1
Relu #37 on 32448 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #20 called N=1, H=13, W=13, CI=384, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
expect 2519700 but got 2519701
expect -2965206 but got -2965205
[32mConvolution Output Matches[0m
Relu task 1
Relu #39 on 10816 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #21 called N=1, H=13, W=13, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
expect 156723 but got 156724
expect -4099546 but got -4099545
[32mConvolution Output Matches[0m
Relu task 1
Relu #41 on 43264 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #22 called N=1, H=13, W=13, CI=64, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
expect 24493406 but got 24493407
expect 10097138 but got 10097139
[32mConvolution Output Matches[0m
Relu task 1
Relu #43 on 43264 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #23 called N=1, H=13, W=13, CI=512, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
expect 61026904 but got 61026905
expect 96970078 but got 96970079
[32mConvolution Output Matches[0m
Relu task 1
Relu #45 on 10816 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #24 called N=1, H=13, W=13, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
expect -58381860 but got -58381859
expect -94513757 but got -94513756
expect 46318565 but got 46318564
[32mConvolution Output Matches[0m
Relu task 1
Relu #47 on 43264 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #25 called N=1, H=13, W=13, CI=64, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
expect -15505736 but got -15505735
expect -15115020 but got -15115019
[32mConvolution Output Matches[0m
Relu task 1
Relu #49 on 43264 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Layer 21, task 1
Conv2DWrapper, task number: 1
Conv2DWrapper, point 1, task number: 1
HomConv #26 called N=1, H=13, W=13, CI=512, FH=1, FW=1, CO=1000, S=1, Padding VALID (0 0 0 0)
expect 67228370 but got 67228371
expect 50337038 but got 50337039
expect 78678739 but got 78678738
expect 32611462 but got 32611461
[32mConvolution Output Matches[0m
Relu task 1
Relu #51 on 169000 points, truncate=1 by 12 bits
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Mill dotrunc 1 on 16 bits using b = 4
Relu point 1 task 1
Relu point 1.5 task 1
Started all threads, task 1
Relu point 2 task 1
Relu point 3 task 1
Layer 22, task 1
AvgPool 1 called N=1, H=1, W=1, C=1000, ksizeH=13, ksizeW=13
ArgMax 1 called, s1=1, s2=1000
Thread i = 0, total data sent till now = 48300204
Thread i = 1, total data sent till now = 46158242
Thread i = 2, total data sent till now = 15339225
Thread i = 3, total data sent till now = 46160049
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 9193 milliseconds.
Total data sent = 141.889 MiB.
Number of rounds = 802
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
top-10 values from SqueezeNet
[13.4096680,13.1931152,12.8901367,12.8723145,12.4887695,12.4672852,12.2910156,12.1828613,12.1240234,12.0104980,]
predicted label = 111
